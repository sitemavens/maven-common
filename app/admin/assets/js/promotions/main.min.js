/**
 * @license RequireJS text 2.0.5+ Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

define("models/promotion",["dateJS"],function(){var e=Backbone.Model.extend({action:"promotionEntryPoint",defaults:{enabled:!0,exclusive:!1,limitOfUse:0,uses:0},initialize:function(){},parse:function(e){return e.from!=undefined&&e.from.length>0&&e.from!="0000-00-00"?e.from=Date.parse(e.from).toString("yyyy-MM-dd"):e.from=null,e.to!=undefined&&e.to.length>0&&e.to!="0000-00-00"?e.to=Date.parse(e.to).toString("yyyy-MM-dd"):e.to=null,e},validation:{section:{required:!0},name:{required:!0},code:{required:!0},type:{required:!0},value:{required:!0,pattern:"number"},enabled:{required:!0},exclusive:{required:!0}}});return e}),define("models/multi-promotion",["dateJS"],function(){var e=Backbone.Model.extend({action:"multiPromotionEntryPoint",defaults:{enabled:!0,exclusive:!1,quantity:1},initialize:function(){},parse:function(e){return e.from!=undefined&&e.from.length>0&&e.from!="0000-00-00"?e.from=Date.parse(e.from).toString("yyyy-MM-dd"):e.from=null,e.to!=undefined&&e.to.length>0&&e.to!="0000-00-00"?e.to=Date.parse(e.to).toString("yyyy-MM-dd"):e.to=null,e},validation:{section:{required:!0},name:{required:!0},type:{required:!0},value:{required:!0,pattern:"number"},enabled:{required:!0},exclusive:{required:!0}}});return e}),define("text",["module"],function(e){var t,n,r,i,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,a=typeof location!="undefined"&&location.href,f=a&&location.protocol&&location.protocol.replace(/\:/,""),l=a&&location.hostname,c=a&&(location.port||undefined),h=[],p=e.config&&e.config()||{};t={version:"2.0.5+",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(u);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(r){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,p.isBuild&&(h[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}p.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),h=p.useXhr||t.useXhr;!a||h(u,f,l,c)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(h.hasOwnProperty(n)){var s=t.jsEscape(h[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(p.env==="node"||!p.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(p.env==="xhr"||!p.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);p.onXhr&&p.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText))},s.send(null)};else if(p.env==="rhino"||!p.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(p.env==="xpconnect"||!p.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var n,s,o={},u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),s.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),o),s.close(),n.close(),t(o.value)}catch(a){throw new Error((u&&u.path||"")+": "+a)}};return t}),define("text!templates/promotions.html",[],function(){return'<!-- // presenters/app/templates/presenters.html -->\n\n<div class="row-fluid">\n	<div class="widget">\n		<div class="widget-title">\n			<h4><i class="icon-reorder"></i>\n				{{ titlePromotions }}</h4>\n			<span class="tools">\n				<button class="btn btn-success" id="add"><i class="icon-plus"></i>&nbsp;{{ buttonAddPromotion }}</button>\n				<button class="btn btn-info" id="multi"><i class="icon-copy"></i>&nbsp;{{ buttonAddMultiplePromotions }}</button>\n				<button class="btn btn-default" id="export"><i class="icon-table"></i>&nbsp;{{ buttonExport }}</button>\n			</span>\n		</div>  \n		<div class="widget-body">\n			<div id="promotions"></div>\n		</div>\n	</div>\n</div>\n\n\n'}),define("collections/promotions",["models/promotion","pageable"],function(e){var t=Backbone.MavenCollection.extend({model:e,action:"promotionEntryPoint",initialize:function(){}});return t}),define("text!templates/promotion-row.html",[],function(){return'<td id="enabled"><img id="enabledImage" /></td>\n<td id="name"></td>\n<td id="code"></td>\n<td id="section"></td>\n<td id="from"></td>\n<td id="to"></td>\n<td>\n	<button class="btn btn-primary btn-mini" id="edit"><i class="icon-edit"></i>&nbsp;{{ buttonEditPromotion }}</button>\n	<a id="confirmDeleteButton" class="btn btn-mini" role="button"><i class="icon-trash"></i>&nbsp;{{ buttonDeletePromotion }}</a>\n	<div aria-hidden="true" aria-labelledby="myModalLabel3" role="dialog" \n	     tabindex="-1" class="modal fade" id="confirmDeleteModal" style="display: none;">\n		<div class="modal-header">\n			<button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>\n			<h3 id="myModalLabel3">{{ deleteConfirmationMessage }}</h3>\n		</div>\n		<div class="modal-body">\n			<p><strong>{{ columnName }}:&nbsp;</strong><span id="name"></span></p>\n			<div class="alert alert-block alert-error fade in">\n				<!--<button data-dismiss="alert" class="close" type="button">×</button>-->\n				<h4 class="alert-heading">{{promotionDeleteWarning}}</h4>\n				<p>\n					{{promotionDeleteWarningMessage}}\n				</p>\n			</div>\n		</div>\n		<div class="modal-footer">\n			<button aria-hidden="true" data-dismiss="modal" class="btn">{{ buttonCloseModal }}</button>\n			<button class="btn btn-danger" id="performDelete" data-dismiss="modal">{{ buttonConfirmDelete }}</button>\n		</div>\n	</div>\n</td>\n'}),define("views/promotion-row",["jquery","localization","notifications","text!templates/promotion-row.html"],function(e,t,n,r){var i=Backbone.View.extend({tagName:"tr",template:_.template(r),editRoute:_.template("promotion/edit/{{ id }}"),events:{"click button[id=edit]":"editPromotion","click a[id=confirmDeleteButton]":"showDelete","click button[id=performDelete]":"deletePromotion"},initialize:function(){_.bindAll(this,"editPromotion","showDelete","deletePromotion"),this.model.bind("change",this.render)},bindings:{"#enabledImage":{attributes:[{name:"src",observe:"statusImageUrl",onGet:function(e,t){return e?e:""}},{name:"alt",observe:"enabled",onGet:function(e,n){return e?t.get("enabled"):t.get("disabled")}}]},"#name":"name","#section":{observe:"section",onGet:function(e,t){var n=_.find(CachedPromotionSections,function(t){return t.value===e});return n?n.label:e}},"#code":"code","#from":{observe:"from",onGet:function(e,t){return e?e:""}},"#to":{observe:"to",onGet:function(e,t){return e?e:""}}},render:function(){return e(this.el).append(this.template(t.toJSON())),this.stickit(),e(this.el)},showDelete:function(){this.$("#confirmDeleteModal").modal()},destroy_view:function(){e(this.el).toggleClass("error");var t=this;e(this.el).fadeOut("slow",function(){t.undelegateEvents(),t.$el.removeData().unbind(),t.remove(),Backbone.View.prototype.remove.call(t)})},editPromotion:function(){Backbone.history.navigate(this.editRoute(this.model.toJSON()),{trigger:!0})},deletePromotion:function(){var e=this;this.model.destroy({success:function(){n.showDelete(t.get("PromotionDeleted")),e.destroy_view()}})}});return i}),define("text!templates/empty.html",[],function(){return'<img class="img-no-presenters" />\n<span>{{ message }}</span>\n'}),define("models/export",[],function(){var e=Backbone.Model.extend({action:"exportEntryPoint",defaults:{},initialize:function(){}});return e}),define("views/promotions",["jquery","dataTables","spinner","localization","text!templates/promotions.html","collections/promotions","views/promotion-row","text!templates/empty.html","models/export","backgridPaginator","backgridFilter","backgrid"],function(e,t,n,r,i,s,o,u,a){var f=Backgrid.ActionCell.extend({editRoute:_.template("promotion/edit/{{ id }}")}),l=Backgrid.Cell.extend({template:_.template("<img id='statusImage' src='{{statusImageUrl}}' />"),render:function(){return this.$el.html(this.template(this.model.toJSON())),this}}),c=Backgrid.Cell.extend({template:_.template("{{uses}} / {{limitOfUse}}"),render:function(){var e={};e.uses=this.model.get("uses");var t=this.model.get("limitOfUse");return e.limitOfUse=t=="0"?r.get("unlimited"):t,this.$el.html(this.template(e)),this}}),h=Backbone.View.extend({template:_.template(i),emptyTemplate:_.template(u),events:{"click #add":"addNew","click #multi":"addMulti","click #export":"exportGrid"},initialize:function(){_.bindAll(this,"addNew","addMulti","exportGrid");var e=this;this.collection.fetch({success:function(t,n){e.render()},error:function(e,t){}})},addOne:function(t){var n=new o({model:t});e("table",this.el).append(n.render())},addAll:function(){this.collection.each(this.addOne)},addNew:function(){Backbone.history.navigate("promotion/new",{trigger:!0})},addMulti:function(){Backbone.history.navigate("promotion/multi",{trigger:!0})},exportGrid:function(){var e=new a;this.collection.state.sortKey&&e.set("sort_by",this.collection.state.sortKey),this.collection.state.order&&(this.collection.state.order==1&&e.set("order","desc"),this.collection.state.order==-1&&e.set("order","asc")),e.export()},render:function(){this.$el.html(this.template(r.toJSON()));var e=[{name:"",editable:!1,cell:f},{name:"enabled",label:"Status",editable:!1,cell:l},{name:"name",label:"Name",editable:!1,cell:"string"},{name:"code",label:"Code",editable:!1,cell:"string"},{name:"section",label:"Section",editable:!1,cell:"string"},{name:"uses",label:"Uses",editable:!1,cell:c},{name:"from",label:"From",editable:!1,cell:"date"},{name:"to",label:"To",editable:!1,cell:"date"}],t=new Backgrid.Grid({className:"backgrid table table-striped table-condensed table-hover",columns:e,collection:this.collection,emptyText:r.get("emptyResult")});this.$("#promotions").html(t.render().$el);var i=new Backgrid.Extension.Paginator({collection:this.collection});return this.$("#promotions").append(i.render().$el),n.stop(),this}});return h}),define("text!templates/promotion-edit.html",[],function(){return'<div class="row-fluid">\n	<div class="widget widget-tabs widget-tabs-left">\n		<div class="widget-title">\n			<span class="tools"></span>\n		</div>\n		<div class="widget-body">\n			<div class="form-horizontal">\n				<div class="tabbable portlet-tabs">\n					<ul class="nav nav-tabs">\n						<li class="active"><a href="#promotion_data" data-toggle="tab"><i class="icon-user-md"></i>&nbsp;{{tabEditPromotion}}</a></li>\n					</ul>\n					<div class="tab-content" >\n						<div class="tab-pane fade in active" id="promotion_data">\n							<div  class="control-group">\n								<label class="control-label" for="enabled">{{enabled}}:</label>\n								<div class="controls">\n									<div class="toggle-button">\n										<input type="checkbox" class="toggle" name="enabled" id="enabled"/>\n									</div>\n								</div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="section">{{section}}:</label>\n								<div class="controls">\n									<select class="input-large" name="section" id="section" data-error-style="inline"/></select>\n									<span class="help-inline" id="section-help"></span>\n								</div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="name">{{name}}:</label>\n								<div class="controls"><input class="input-xxlarge" type="text" name="name" id="name" data-error-style="inline"/></div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="code">{{code}}:</label>\n								<div class="controls"><input class="input-xlarge" type="text" name="code" id="code" /></div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="type">{{type}}:</label>\n								<div class="controls"><select class="input-large" name="type" id="type" data-error-style="inline"/></select></div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="value">{{value}}:</label>\n								<div class="controls"><div class="input-prepend"><span id="typeSymbol" class="add-on">?</span><input class="input-medium" type="text" name="value" id="value" data-error-style="inline"/></div></div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="limitOfUse">{{limitOfUse}}:</label>\n								<div class="controls">\n									<input class="input-small" type="text" name="limitOfUse" id="limitOfUse" />\n									<span class="help-inline">Use 0 for <strong>no limit</strong></span>\n								</div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="uses">{{uses}}:</label>\n								<div class="controls"><input class="input-small" type="text" name="uses" id="uses" readonly="readonly" /></div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="from">{{from}}:</label>\n								<div class="controls">\n									<div class="input-append date date-picker">\n										<input class="input-large datepicker" type="text" name="from" id="from" />\n										<span id="showCalendar" class="add-on"><i class="icon-calendar"></i></span>\n									</div>\n								</div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="to">{{to}}:</label>\n								<div class="controls">\n									<div class="input-append date date-picker">\n										<input class="input-large datepicker" type="text" name="to" id="to" />\n										<span id="showCalendar" class="add-on"><i class="icon-calendar"></i></span>\n									</div>\n								</div>\n							</div>\n\n							<!--<div  class="control-group">\n								<label class="control-label" for="exclusive">{{exclusive}}:</label>\n								<div class="controls">\n									<div class="toggle-button">\n										<input type="checkbox" class="toggle" name="exclusive" id="exclusive"/></div>\n								</div>\n\n\n							</div>-->\n							<div  class="control-group">\n								<label class="control-label" for="description">{{description}}:</label>\n								<div class="controls">\n									<textarea  class="simpleEditor span9 wysihtml5" rows="20" cols="20" name="description" id="description"></textarea>\n								</div>\n							</div>\n						</div>	\n					</div>\n				</div>\n				<div class="form-actions">\n					<button class="btn btn-success" id="save"><i class="icon-save"></i>&nbsp;{{buttonSavePromotion}}</button>\n					<button class="btn" id="cancel"><i class="icon-remove"></i>&nbsp;{{buttonCancelEditPromotion}}</button>\n				</div>\n			</div>\n		</div>\n\n	</div>\n\n</div>\n'}),define("views/promotion-edit",["jquery","localization","notifications","spinner","text!templates/promotion-edit.html","toggleButtons","wysihtml5","datePicker"],function(e,t,n,r,i){return Backbone.View.extend({template:_.template(i),initialize:function(e){_.bindAll(this,"savePresenter","cancelPresenter","typeChanged","sectionChanged"),this.model.id||r.stop(),this.model.on("change:section",this.sectionChanged),this.model.on("change:type",this.typeChanged),this.render()},events:{"click #save":"savePresenter","click #cancel":"cancelPresenter"},sectionChanged:function(e,n){n===""?this.$("#section-help").html(""):this.$("#section-help").html(t.get(n))},typeChanged:function(e,t){var n=_.find(CachedPromotionTypes,function(e){return e["value"]==t});this.$("#typeSymbol").text(n.symbol)},bindings:{"#enabled":"enabled","#section":{observe:"section",selectOptions:{collection:function(){return CachedPromotionSections}},labelPath:"name",valuePath:"value"},"#name":"name","#code":"code","#type":{observe:"type",selectOptions:{collection:function(){return CachedPromotionTypes}},labelPath:"name",valuePath:"value"},"#value":"value","#limitOfUse":"limitOfUse","#uses":"uses","#from":{observe:"from",onGet:function(e){return e?Date.parse(e).toString(Date.CultureInfo.formatPatterns.shortDate):""},onSet:function(e){return e?Date.parse(e).toString("yyyy-MM-dd"):""}},"#to":{observe:"to",onGet:function(e){return e?Date.parse(e).toString(Date.CultureInfo.formatPatterns.shortDate):""},onSet:function(e){return e?Date.parse(e).toString("yyyy-MM-dd"):""}},"#exclusive":"exclusive","#description":"description"},render:function(){var n=this;e(this.el).html(this.template(t.toJSON())),this.$("#nav a").click(function(t){t.preventDefault(),e(this).tab("show")}),this.$("#from").datepicker({format:"m/d/yyyy",autoclose:!0}),this.model.get("from")&&this.$("#from").val(Date.parse(this.model.get("from")).toString(Date.CultureInfo.formatPatterns.shortDate)).datepicker("update");if(this.model.get("type")){var r=_.find(CachedPromotionTypes,function(e){return e["value"]==n.model.get("type")});this.$("#typeSymbol").text(r.symbol)}else this.$("#typeSymbol").text(" ");return this.$("#to").datepicker({format:"m/d/yyyy",autoclose:!0}),this.model.get("to")&&this.$("#to").val(Date.parse(this.model.get("to")).toString(Date.CultureInfo.formatPatterns.shortDate)).datepicker("update"),this.stickit(),Backbone.Validation.bind(this,{forceUpdate:!0}),this.$(".wysihtml5").wysihtml5({html:!0,stylesheets:!1}),this.$(".toggle-button").toggleButtons({width:100,label:{enabled:t.get("yes"),disabled:t.get("no")}}),this},savePresenter:function(e){e.preventDefault();var r=this.$("#description").val();this.model.set("description",r),this.model.isValid(!0)?this.model.save(null,{success:function(){Backbone.history.navigate("",{trigger:!0})},failure:function(e){n.showError(t.get("saveError"))}}):n.showError(t.get("saveError"))},cancelPresenter:function(){Backbone.history.navigate("",{trigger:!0})}})}),define("text!templates/multi-promotion-edit.html",[],function(){return'<div class="row-fluid">\n	<div class="widget widget-tabs widget-tabs-left">\n		<div class="widget-title">\n			<span class="tools"></span>\n		</div>\n		<div class="widget-body">\n			<div class="form-horizontal">\n				<div class="tabbable portlet-tabs">\n					<ul class="nav nav-tabs">\n						<li class="active"><a href="#promotion_data" data-toggle="tab"><i class="icon-circle-arrow-down"></i>&nbsp;{{tabEditPromotion}}</a></li>\n					</ul>\n					<div class="tab-content" >\n						<div class="tab-pane fade in active" id="promotion_data">\n							<div class="alert alert-info">\n								<!--<button data-dismiss="alert" class="close">×</button>-->\n								Here you can create similar promotions with diferent codes.<br />\n								Just set the quantity and configure your promotion. 								\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="quantity">{{quantity}}:</label>\n								<div class="controls"><input class="input-small" type="text" name="quantity" id="quantity" /></div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="enabled">{{enabled}}:</label>\n								<div class="controls">\n									<div class="toggle-button">\n										<input type="checkbox" class="toggle" name="enabled" id="enabled"/>\n									</div>\n								</div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="section">{{section}}:</label>\n								<div class="controls">\n									<select class="input-large" name="section" id="section" data-error-style="inline"/></select>\n									<span class="help-inline" id="section-help"></span>\n								</div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="name">{{name}}:</label>\n								<div class="controls"><input class="input-xxlarge" type="text" name="name" id="name" data-error-style="inline"/></div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="type">{{type}}:</label>\n								<div class="controls"><select class="input-large" name="type" id="type" data-error-style="inline"/></select></div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="value">{{value}}:</label>\n								<div class="controls"><div class="input-prepend"><span id="typeSymbol" class="add-on">?</span><input class="input-medium" type="text" name="value" id="value" data-error-style="inline"/></div></div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="limitOfUse">{{limitOfUse}}:</label>\n								<div class="controls">\n									<input class="input-small" type="text" name="limitOfUse" id="limitOfUse" />\n									<span class="help-inline">Use 0 for <strong>no limit</strong></span>\n								</div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="from">{{from}}:</label>\n								<div class="controls">\n									<div class="input-append date date-picker">\n										<input class="input-large datepicker" type="text" name="from" id="from" />\n										<span id="showCalendar" class="add-on"><i class="icon-calendar"></i></span>\n									</div>\n								</div>\n							</div>\n							<div  class="control-group">\n								<label class="control-label" for="to">{{to}}:</label>\n								<div class="controls">\n									<div class="input-append date date-picker">\n										<input class="input-large datepicker" type="text" name="to" id="to" />\n										<span id="showCalendar" class="add-on"><i class="icon-calendar"></i></span>\n									</div>\n								</div>\n							</div>\n\n							<!--<div  class="control-group">\n								<label class="control-label" for="exclusive">{{exclusive}}:</label>\n								<div class="controls">\n									<div class="toggle-button">\n										<input type="checkbox" class="toggle" name="exclusive" id="exclusive"/></div>\n								</div>\n\n\n							</div>-->\n							<div  class="control-group">\n								<label class="control-label" for="description">{{description}}:</label>\n								<div class="controls">\n									<textarea  class="simpleEditor span9 wysihtml5" rows="20" cols="20" name="description" id="description"></textarea>\n								</div>\n							</div>\n						</div>	\n					</div>\n				</div>\n				<div class="form-actions">\n					<button class="btn btn-success" id="save"><i class="icon-save"></i>&nbsp;{{buttonSavePromotion}}</button>\n					<button class="btn" id="cancel"><i class="icon-remove"></i>&nbsp;{{buttonCancelEditPromotion}}</button>\n				</div>\n			</div>\n		</div>\n\n	</div>\n\n</div>\n'}),define("views/multi-promotion-edit",["jquery","localization","notifications","spinner","text!templates/multi-promotion-edit.html","toggleButtons","wysihtml5","datePicker"],function(e,t,n,r,i){return Backbone.View.extend({template:_.template(i),initialize:function(e){_.bindAll(this,"savePromotion","cancelPromotion","typeChanged","sectionChanged"),this.model.id||r.stop(),this.model.on("change:section",this.sectionChanged),this.model.on("change:type",this.typeChanged),this.render()},events:{"click #save":"savePromotion","click #cancel":"cancelPromotion"},sectionChanged:function(e,n){n===""?this.$("#section-help").html(""):this.$("#section-help").html(t.get(n))},typeChanged:function(e,t){var n=_.find(CachedPromotionTypes,function(e){return e["value"]==t});this.$("#typeSymbol").text(n.symbol)},bindings:{"#quantity":"quantity","#enabled":"enabled","#section":{observe:"section",selectOptions:{collection:function(){return CachedPromotionSections}},labelPath:"name",valuePath:"value"},"#name":"name","#type":{observe:"type",selectOptions:{collection:function(){return CachedPromotionTypes}},labelPath:"name",valuePath:"value"},"#value":"value","#limitOfUse":"limitOfUse","#from":{observe:"from",onGet:function(e){return e?Date.parse(e).toString(Date.CultureInfo.formatPatterns.shortDate):""},onSet:function(e){return e?Date.parse(e).toString("yyyy-MM-dd"):""}},"#to":{observe:"to",onGet:function(e){return e?Date.parse(e).toString(Date.CultureInfo.formatPatterns.shortDate):""},onSet:function(e){return e?Date.parse(e).toString("yyyy-MM-dd"):""}},"#exclusive":"exclusive","#description":"description"},render:function(){var n=this;e(this.el).html(this.template(t.toJSON())),this.$("#nav a").click(function(t){t.preventDefault(),e(this).tab("show")}),this.$("#from").datepicker({format:"m/d/yyyy",autoclose:!0}),this.model.get("from")&&this.$("#from").val(Date.parse(this.model.get("from")).toString(Date.CultureInfo.formatPatterns.shortDate)).datepicker("update");if(this.model.get("type")){var r=_.find(CachedPromotionTypes,function(e){return e["value"]==n.model.get("type")});this.$("#typeSymbol").text(r.symbol)}else this.$("#typeSymbol").text(" ");return this.$("#to").datepicker({format:"m/d/yyyy",autoclose:!0}),this.model.get("to")&&this.$("#to").val(Date.parse(this.model.get("to")).toString(Date.CultureInfo.formatPatterns.shortDate)).datepicker("update"),this.stickit(),Backbone.Validation.bind(this,{forceUpdate:!0}),this.$(".wysihtml5").wysihtml5({html:!0,stylesheets:!1}),this.$(".toggle-button").toggleButtons({width:100,label:{enabled:t.get("yes"),disabled:t.get("no")}}),this},savePromotion:function(e){e.preventDefault();var r=this.$("#description").val();this.model.set("description",r),this.model.isValid(!0)?this.model.save(null,{success:function(){Backbone.history.navigate("",{trigger:!0})},failure:function(e){n.showError(t.get("saveError"))}}):n.showError(t.get("saveError"))},cancelPromotion:function(){Backbone.history.navigate("",{trigger:!0})}})}),define("router",["require","jquery","models/promotion","models/multi-promotion","views/promotions","notifications","collections/promotions","spinner","views/promotion-edit","views/multi-promotion-edit"],function(e){var t=e("jquery"),n=e("models/promotion"),r=e("models/multi-promotion"),i=e("views/promotions"),s=e("notifications"),o=e("collections/promotions"),u=e("spinner"),a=e("views/promotion-edit"),f=e("views/multi-promotion-edit");return Backbone.Router.extend({promotionsView:null,routes:{"promotion/new":"newPromotion","promotion/multi":"newMultiPromotion","promotion/edit/:id":"editPromotion",promotions:"defaultRoute","*path":"defaultRoute"},initialize:function(e){this.el=e.el,this.collection=new o},defaultRoute:function(){this.promotionsView=new i({el:this.el,collection:this.collection})},newPromotion:function(){var e=new n;t(this.el).html((new a({model:e})).el)},newMultiPromotion:function(){var e=new r;t(this.el).html((new f({model:e})).el)},editPromotion:function(e){var r=this,i=new n({id:e});i.fetch({success:function(e){t(r.el).html((new a({model:e})).el)},failure:function(e){s.showError(e),u.stop()}})}})}),define("app",["require","router"],function(e){var t=e("router");return function(e){new t({el:e}),Backbone.history.start()}}),require(["domReady","app","jquery"],function(e,t,n){e(function(){var e=new t("#mainContainer")})}),define("main",function(){});